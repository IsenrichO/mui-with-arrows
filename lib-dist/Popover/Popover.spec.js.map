{"version":3,"sources":["../../src/Popover/Popover.spec.js"],"names":["describe","muiTheme","shallowWithContext","node","context","mountWithContext","it","wrapper","setProps","open","timeout","instance","nextTimeout","strictEqual","done","handleScroll","unmount","setTimeout","Layer","renderLayer","layerWrapper","find","length","test","window","navigator","userAgent","input","beforeEach","document","createElement","body","appendChild","focus","afterEach","remove","getBoundingClientRect","x","y","width","height","top","right","bottom","left","el","offsetHeight","offsetWidth","offsetParent","offsetTop","userAgentsWithIOS","nonIOSuserAgents","forEach","agent","__defineGetter__","result","getAnchorPosition","expected","center","middle","deepEqual","after","getUserAgent","appCodeName","appVersion"],"mappings":"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","file":"Popover.spec.js","sourcesContent":["/* eslint-env mocha */\n\nimport React from 'react';\nimport {assert} from 'chai';\nimport {shallow, mount} from 'enzyme';\nimport Popover from './Popover';\nimport PopoverAnimationDefault from './PopoverAnimationDefault';\nimport Paper from '../Paper';\nimport getMuiTheme from '../styles/getMuiTheme';\n\ndescribe('<Popover />', () => {\n  const muiTheme = getMuiTheme();\n  const shallowWithContext = (node) => shallow(node, {context: {muiTheme}});\n  const mountWithContext = (node) => mount(node, {context: {muiTheme}});\n\n  describe('state: closing', () => {\n    it('should not create new timeout when popover is already closing', () => {\n      const wrapper = shallowWithContext(<Popover open={true} />);\n\n      wrapper.setProps({open: false});\n      const timeout = wrapper.instance().timeout;\n\n      wrapper.setProps({open: false});\n      const nextTimeout = wrapper.instance().timeout;\n\n      assert.strictEqual(timeout, nextTimeout);\n    });\n  });\n\n  describe('unmounting', () => {\n    it('should stop listening correctly', (done) => {\n      const wrapper = mountWithContext(<Popover open={true} />);\n\n      wrapper.instance().handleScroll();\n      wrapper.instance().handleScroll();\n      wrapper.unmount();\n\n      setTimeout(() => {\n         // Wait for the end of the throttle. Makes sure we don't crash.\n        done();\n      }, 100);\n    });\n  });\n\n  describe('prop: animated', () => {\n    it('should use a Paper when animated if false', () => {\n      const wrapper = shallowWithContext(<Popover open={true} animated={false} />);\n      const Layer = () => wrapper.instance().renderLayer();\n      const layerWrapper = shallowWithContext(<Layer />);\n\n      assert.strictEqual(layerWrapper.find(Paper).length, 1);\n    });\n\n    it('should use an animation when animated if true', () => {\n      const wrapper = shallowWithContext(<Popover open={true} animated={true} />);\n      const Layer = () => wrapper.instance().renderLayer();\n      const layerWrapper = shallowWithContext(<Layer />);\n\n      assert.strictEqual(layerWrapper.find(PopoverAnimationDefault).length, 1);\n    });\n  });\n\n  describe('IOS detection', () => {\n    // skip tests on PhantomJS because __defineGetter__ method seems not working\n    if (/PhantomJS/.test(window.navigator.userAgent)) {\n      return;\n    }\n\n    let input;\n\n    beforeEach(() => {\n      input = document.createElement('input');\n      document.body.appendChild(input);\n      input.focus();\n    });\n\n    afterEach(() => {\n      input.remove();\n    });\n\n    const getBoundingClientRect = () => ({\n      x: 10,\n      y: 10,\n      width: 10,\n      height: 10,\n      top: 10,\n      right: 10,\n      bottom: 10,\n      left: 10,\n    });\n\n    const el = {\n      offsetHeight: 10,\n      offsetWidth: 10,\n      offsetParent: {\n        offsetTop: 10,\n        offsetParent: null,\n      },\n      offsetTop: 10,\n      getBoundingClientRect,\n    };\n    /* eslint-disable max-len */\n    const userAgentsWithIOS = [\n      'Mozilla/5.0 (iPhone; CPU iPhone OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/7.0 Mobile/11A465 Safari/9537.53',\n      'Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/7.0 Mobile/11A465 Safari/9537.53',\n      'Mozilla/5.0 (iPod; U; CPU like Mac OS X; en) AppleWebKit/420.1 (KHTML, like Gecko) Version/3.0 Mobile/3A101a Safari/419.3',\n    ];\n    const nonIOSuserAgents = [\n      'Mozilla/5.0 (compatible; MSIE 9.0; Windows Phone OS 7.5; Trident/5.0; IEMobile/9.0)',\n      'Mozilla/5.0 (Linux; Android 4.4.4; Nexus 7 Build/KTU84Q) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/33.0.0.0 Safari/537.36',\n      'Mozilla/5.0 (BlackBerry; U; BlackBerry 9900; en) AppleWebKit/534.11+ (KHTML, like Gecko) Version/7.1.0.346 Mobile Safari/534.11+',\n    ];\n    /* eslint-enable max-len */\n\n    userAgentsWithIOS.forEach((agent) => {\n      it(`should use absolute positioning for ${agent}`, () => {\n        window.navigator.__defineGetter__('userAgent', () => agent); // eslint-disable-line no-underscore-dangle,max-len\n        const wrapper = mountWithContext(<Popover open={true} animated={true} />);\n        const result = wrapper.instance().getAnchorPosition(el);\n        const expected = {bottom: 30, top: 10, center: 20, left: 10, right: 10, middle: 10, height: 10, width: 10};\n        assert.deepEqual(result, expected);\n      });\n    });\n\n    nonIOSuserAgents.forEach((agent) => {\n      it(`should use normal positioning for ${agent}`, () => {\n        window.navigator.__defineGetter__('userAgent', () => agent); // eslint-disable-line no-underscore-dangle,max-len\n        const wrapper = mountWithContext(<Popover open={true} animated={true} />);\n        const result = wrapper.instance().getAnchorPosition(el);\n        const expected = {bottom: 10, top: 10, center: 10, left: 10, right: 10, middle: 10, height: 10, width: 10};\n        assert.deepEqual(result, expected);\n      });\n    });\n\n    after(() => {\n      window.navigator.__defineGetter__('userAgent', function getUserAgent() { // eslint-disable-line no-underscore-dangle,max-len\n        return `${this.appCodeName}/${this.appVersion}`;\n      });\n    });\n  });\n});\n"]}