{"version":3,"sources":["../../src/Popover/Popover.js"],"names":["styles","root","display","Popover","props","context","timeout","renderLayer","animated","animation","anchorEl","anchorOrigin","autoCloseWhenOffScreen","canAutoPosition","children","onRequestClose","style","targetOrigin","useLayerForClickAway","other","styleRoot","position","zIndex","muiTheme","popover","state","open","Animation","closing","componentClickAway","event","preventDefault","requestClose","setPlacement","scrolling","refs","layer","getLayer","targetEl","anchor","getAnchorPosition","target","getTargetPosition","targetPosition","top","vertical","left","horizontal","applyAutoPositionIfNeeded","Math","max","maxHeight","window","innerHeight","handleResize","handleScroll","bind","componentDidMount","componentWillReceiveProps","nextProps","clearTimeout","setState","setTimeout","componentDidUpdate","componentWillUnmount","cancel","reason","el","findDOMNode","rect","getBoundingClientRect","a","width","offsetWidth","height","offsetHeight","right","document","activeElement","tagName","bottom","middle","center","anchorPosition","innerWidth","getOverlapMode","median","indexOf","getPositions","t","positions","x","filter","p","y","overlap","splice","anchorPos","newTop","newLeft","render","propTypes","object","origin","bool","func","node","className","string","zDepth","defaultProps","overflowY","contextTypes","isRequired"],"mappings":"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","file":"Popover.js","sourcesContent":["import React, {Component} from 'react';\nimport PropTypes from 'prop-types';\nimport ReactDOM from 'react-dom';\nimport EventListener from 'react-event-listener';\nimport RenderToLayer from '../internal/RenderToLayer';\nimport propTypes from '../utils/propTypes';\nimport Paper from '../Paper';\nimport throttle from 'lodash.throttle';\nimport PopoverAnimationDefault from './PopoverAnimationDefault';\nimport {isIOS, getOffsetTop} from '../utils/iOSHelpers';\n\nconst styles = {\n  root: {\n    display: 'none',\n  },\n};\n\nclass Popover extends Component {\n  static propTypes = {\n    /**\n     * This is the DOM element that will be used to set the position of the\n     * popover.\n     */\n    anchorEl: PropTypes.object,\n    /**\n     * This is the point on the anchor where the popover's\n     * `targetOrigin` will attach to.\n     * Options:\n     * vertical: [top, center, bottom]\n     * horizontal: [left, middle, right].\n     */\n    anchorOrigin: propTypes.origin,\n    /**\n     * If true, the popover will apply transitions when\n     * it is added to the DOM.\n     */\n    animated: PropTypes.bool,\n    /**\n     * Override the default animation component used.\n     */\n    animation: PropTypes.func,\n    /**\n     * If true, the popover will hide when the anchor is scrolled off the screen.\n     */\n    autoCloseWhenOffScreen: PropTypes.bool,\n    /**\n     * If true, the popover (potentially) ignores `targetOrigin`\n     * and `anchorOrigin` to make itself fit on screen,\n     * which is useful for mobile devices.\n     */\n    canAutoPosition: PropTypes.bool,\n    /**\n     * The content of the popover.\n     */\n    children: PropTypes.node,\n    /**\n     * The CSS class name of the root element.\n     */\n    className: PropTypes.string,\n    /**\n     * Callback function fired when the popover is requested to be closed.\n     *\n     * @param {string} reason The reason for the close request. Possibles values\n     * are 'clickAway' and 'offScreen'.\n     */\n    onRequestClose: PropTypes.func,\n    /**\n     * If true, the popover is visible.\n     */\n    open: PropTypes.bool,\n    /**\n     * Override the inline-styles of the root element.\n     */\n    style: PropTypes.object,\n    /**\n     * This is the point on the popover which will attach to\n     * the anchor's origin.\n     * Options:\n     * vertical: [top, center, bottom]\n     * horizontal: [left, middle, right].\n     */\n    targetOrigin: propTypes.origin,\n    /**\n     * If true, the popover will render on top of an invisible\n     * layer, which will prevent clicks to the underlying\n     * elements, and trigger an `onRequestClose('clickAway')` call.\n     */\n    useLayerForClickAway: PropTypes.bool,\n    /**\n     * The zDepth of the popover.\n     */\n    zDepth: propTypes.zDepth,\n  };\n\n  static defaultProps = {\n    anchorOrigin: {\n      vertical: 'bottom',\n      horizontal: 'left',\n    },\n    animated: true,\n    autoCloseWhenOffScreen: true,\n    canAutoPosition: true,\n    onRequestClose: () => {},\n    open: false,\n    style: {\n      overflowY: 'auto',\n    },\n    targetOrigin: {\n      vertical: 'top',\n      horizontal: 'left',\n    },\n    useLayerForClickAway: true,\n    zDepth: 1,\n  };\n\n  static contextTypes = {\n    muiTheme: PropTypes.object.isRequired,\n  };\n\n  constructor(props, context) {\n    super(props, context);\n    this.handleResize = throttle(this.setPlacement, 100);\n    this.handleScroll = throttle(this.setPlacement.bind(this, true), 50);\n\n    this.state = {\n      open: props.open,\n      closing: false,\n    };\n  }\n\n  componentDidMount() {\n    this.setPlacement();\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.open === this.props.open) {\n      return;\n    }\n\n    if (nextProps.open) {\n      clearTimeout(this.timeout);\n      this.timeout = null;\n      this.anchorEl = nextProps.anchorEl || this.props.anchorEl;\n      this.setState({\n        open: true,\n        closing: false,\n      });\n    } else {\n      if (nextProps.animated) {\n        if (this.timeout !== null) return;\n        this.setState({closing: true});\n        this.timeout = setTimeout(() => {\n          this.setState({\n            open: false,\n          }, () => {\n            this.timeout = null;\n          });\n        }, 500);\n      } else {\n        this.setState({\n          open: false,\n        });\n      }\n    }\n  }\n\n  componentDidUpdate() {\n    this.setPlacement();\n  }\n\n  componentWillUnmount() {\n    this.handleResize.cancel();\n    this.handleScroll.cancel();\n\n    if (this.timeout) {\n      clearTimeout(this.timeout);\n      this.timeout = null;\n    }\n  }\n\n  timeout = null;\n\n  renderLayer = () => {\n    const {\n      animated,\n      animation,\n      anchorEl, // eslint-disable-line no-unused-vars\n      anchorOrigin, // eslint-disable-line no-unused-vars\n      autoCloseWhenOffScreen, // eslint-disable-line no-unused-vars\n      canAutoPosition, // eslint-disable-line no-unused-vars\n      children,\n      onRequestClose, // eslint-disable-line no-unused-vars\n      style,\n      targetOrigin,\n      useLayerForClickAway, // eslint-disable-line no-unused-vars\n      ...other\n    } = this.props;\n\n    let styleRoot = style;\n\n    if (!animated) {\n      styleRoot = {\n        position: 'fixed',\n        zIndex: this.context.muiTheme.zIndex.popover,\n      };\n\n      if (!this.state.open) {\n        return null;\n      }\n\n      return (\n        <Paper style={Object.assign(styleRoot, style)} {...other}>\n          {children}\n        </Paper>\n      );\n    }\n\n    const Animation = animation || PopoverAnimationDefault;\n\n    return (\n      <Animation\n        targetOrigin={targetOrigin}\n        style={styleRoot}\n        {...other}\n        open={this.state.open && !this.state.closing}\n      >\n        {children}\n      </Animation>\n    );\n  };\n\n  requestClose(reason) {\n    if (this.props.onRequestClose) {\n      this.props.onRequestClose(reason);\n    }\n  }\n\n  componentClickAway = (event) => {\n    event.preventDefault();\n    this.requestClose('clickAway');\n  };\n\n  getAnchorPosition(el) {\n    if (!el) {\n      el = ReactDOM.findDOMNode(this);\n    }\n\n    const rect = el.getBoundingClientRect();\n    const a = {\n      top: rect.top,\n      left: rect.left,\n      width: el.offsetWidth,\n      height: el.offsetHeight,\n    };\n\n    a.right = rect.right || a.left + a.width;\n\n    // The fixed positioning isn't respected on iOS when an input is focused.\n    // We need to compute the position from the top of the page and not the viewport.\n    if (isIOS() && document.activeElement.tagName === 'INPUT') {\n      a.bottom = getOffsetTop(el) + a.height;\n    } else {\n      a.bottom = rect.bottom || a.top + a.height;\n    }\n    a.middle = a.left + ((a.right - a.left) / 2);\n    a.center = a.top + ((a.bottom - a.top) / 2);\n\n    return a;\n  }\n\n  getTargetPosition(targetEl) {\n    return {\n      top: 0,\n      center: targetEl.offsetHeight / 2,\n      bottom: targetEl.offsetHeight,\n      left: 0,\n      middle: targetEl.offsetWidth / 2,\n      right: targetEl.offsetWidth,\n    };\n  }\n\n  setPlacement = (scrolling) => {\n    if (!this.state.open) {\n      return;\n    }\n\n    if (!this.refs.layer.getLayer()) {\n      return;\n    }\n\n    const targetEl = this.refs.layer.getLayer().children[0];\n    if (!targetEl) {\n      return;\n    }\n\n    const {targetOrigin, anchorOrigin} = this.props;\n    const anchorEl = this.props.anchorEl || this.anchorEl;\n\n    const anchor = this.getAnchorPosition(anchorEl);\n    let target = this.getTargetPosition(targetEl);\n\n    let targetPosition = {\n      top: anchor[anchorOrigin.vertical] - target[targetOrigin.vertical],\n      left: anchor[anchorOrigin.horizontal] - target[targetOrigin.horizontal],\n    };\n\n    if (scrolling && this.props.autoCloseWhenOffScreen) {\n      this.autoCloseWhenOffScreen(anchor);\n    }\n\n    if (this.props.canAutoPosition) {\n      target = this.getTargetPosition(targetEl); // update as height may have changed\n      targetPosition = this.applyAutoPositionIfNeeded(anchor, target, targetOrigin, anchorOrigin, targetPosition);\n    }\n\n    targetEl.style.top = `${Math.max(0, targetPosition.top)}px`;\n    targetEl.style.left = `${Math.max(0, targetPosition.left)}px`;\n    targetEl.style.maxHeight = `${window.innerHeight}px`;\n  };\n\n  autoCloseWhenOffScreen(anchorPosition) {\n    if (anchorPosition.top < 0 ||\n      anchorPosition.top > window.innerHeight ||\n      anchorPosition.left < 0 ||\n      anchorPosition.left > window.innerWidth) {\n      this.requestClose('offScreen');\n    }\n  }\n\n  getOverlapMode(anchor, target, median) {\n    if ([anchor, target].indexOf(median) >= 0) return 'auto';\n    if (anchor === target) return 'inclusive';\n    return 'exclusive';\n  }\n\n  getPositions(anchor, target) {\n    const a = {...anchor};\n    const t = {...target};\n\n    const positions = {\n      x: ['left', 'right'].filter((p) => p !== t.horizontal),\n      y: ['top', 'bottom'].filter((p) => p !== t.vertical),\n    };\n\n    const overlap = {\n      x: this.getOverlapMode(a.horizontal, t.horizontal, 'middle'),\n      y: this.getOverlapMode(a.vertical, t.vertical, 'center'),\n    };\n\n    positions.x.splice(overlap.x === 'auto' ? 0 : 1, 0, 'middle');\n    positions.y.splice(overlap.y === 'auto' ? 0 : 1, 0, 'center');\n\n    if (overlap.y !== 'auto') {\n      a.vertical = a.vertical === 'top' ? 'bottom' : 'top';\n      if (overlap.y === 'inclusive') {\n        t.vertical = t.vertical;\n      }\n    }\n\n    if (overlap.x !== 'auto') {\n      a.horizontal = a.horizontal === 'left' ? 'right' : 'left';\n      if (overlap.y === 'inclusive') {\n        t.horizontal = t.horizontal;\n      }\n    }\n\n    return {\n      positions: positions,\n      anchorPos: a,\n    };\n  }\n\n  applyAutoPositionIfNeeded(anchor, target, targetOrigin, anchorOrigin, targetPosition) {\n    const {positions, anchorPos} = this.getPositions(anchorOrigin, targetOrigin);\n\n    if (targetPosition.top < 0 || targetPosition.top + target.bottom > window.innerHeight) {\n      let newTop = anchor[anchorPos.vertical] - target[positions.y[0]];\n      if (newTop + target.bottom <= window.innerHeight) {\n        targetPosition.top = Math.max(0, newTop);\n      } else {\n        newTop = anchor[anchorPos.vertical] - target[positions.y[1]];\n        if (newTop + target.bottom <= window.innerHeight) {\n          targetPosition.top = Math.max(0, newTop);\n        }\n      }\n    }\n\n    if (targetPosition.left < 0 || targetPosition.left + target.right > window.innerWidth) {\n      let newLeft = anchor[anchorPos.horizontal] - target[positions.x[0]];\n      if (newLeft + target.right <= window.innerWidth) {\n        targetPosition.left = Math.max(0, newLeft);\n      } else {\n        newLeft = anchor[anchorPos.horizontal] - target[positions.x[1]];\n        if (newLeft + target.right <= window.innerWidth) {\n          targetPosition.left = Math.max(0, newLeft);\n        }\n      }\n    }\n\n    return targetPosition;\n  }\n\n  render() {\n    return (\n      <div style={styles.root}>\n        <EventListener\n          target=\"window\"\n          onScroll={this.handleScroll}\n          onResize={this.handleResize}\n        />\n        <RenderToLayer\n          ref=\"layer\"\n          open={this.state.open}\n          componentClickAway={this.componentClickAway}\n          useLayerForClickAway={this.props.useLayerForClickAway}\n          render={this.renderLayer}\n        />\n      </div>\n    );\n  }\n}\n\nexport default Popover;\n"]}